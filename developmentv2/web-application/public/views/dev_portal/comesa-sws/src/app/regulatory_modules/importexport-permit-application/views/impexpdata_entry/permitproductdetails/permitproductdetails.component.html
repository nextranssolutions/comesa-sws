<div class="row wizard-content">
    <div class="col-lg-12" *ngIf="regulatory_subfunction_id == 12 || regulatory_subfunction_id == 83">
        <dx-data-grid [dataSource]="permitProductsData" [wordWrapEnabled]="true"
            (onToolbarPreparing)="onPermitProductGridToolbar($event)" [allowColumnResizing]="true"
            [columnHidingEnabled]="false" [showBorders]="true">
            <dxo-filter-row [visible]="false"></dxo-filter-row>
            <dxo-search-panel [visible]="true">
            </dxo-search-panel>
            <dxo-paging [enabled]="true">
            </dxo-paging>
            <dxo-selection mode="single"></dxo-selection>
            <dxi-column [width]="150" caption="{{'action(edit/delete)' | translate}}" name="command-editing" [allowFiltering]="false"
                [allowSorting]="false" cellTemplate="cellTemplate">
                <div *dxTemplate="let data of 'cellTemplate'">

                    <dx-menu (onItemClick)="permitProductsActionColClick($event,data)" [items]="permitProductMenuItems">

                    </dx-menu>
                </div>
            </dxi-column>
            <dxi-column [width]="200" caption="{{'action' | translate}}" name="command-editing" [allowFiltering]="false"
                [allowSorting]="false" cellTemplate="cellTemplate2">
                <div *dxTemplate="let data of 'cellTemplate2'">
                    <dx-button text="{{'Uploads(Certificates)' | translate}}" (click)="funcDownloadUploadedDocuments(data.data)"
                        type="success" icon="download" [elementAttr]="{ class: 'btn btn-primary' }">
                    </dx-button>
                </div>
            </dxi-column>
            <dxi-column dataField="brand_name" caption="{{'brand_name' | translate}}"></dxi-column>
            <dxi-column dataField="quantity" caption="{{'quantity' | translate}}"></dxi-column>
            <dxi-column dataField="packaging_units" caption="{{'packaging_units' | translate}}"></dxi-column>
            <dxi-column dataField="unitpack_size" caption="{{'unitpack_size' | translate}}"></dxi-column>
            <dxi-column dataField="currency_name" caption="{{'currency_name' | translate}}"></dxi-column>
            <dxi-column dataField="unit_price" caption="{{'unit_price' | translate}}"></dxi-column>
            <dxi-column dataField="total_value" caption="total_value"></dxi-column>
            <dxo-paging [enabled]="true">
            </dxo-paging>
            <dxo-summary>
                <dxi-total-item column="total_value" summaryType="sum">
                </dxi-total-item>
            </dxo-summary>
            <dxo-pager [showInfo]="true" infoText="Page #{0}. Total: {1} ({2} items)">
            </dxo-pager>
            <dxo-export [enabled]="true" fileName="permitProducts" [allowExportSelectedData]="true"></dxo-export>
        </dx-data-grid>

    </div>


    <div class="col-lg-12" *ngIf="regulatory_subfunction_id == 79  || regulatory_subfunction_id == 85">
        <dx-data-grid [dataSource]="permitProductsData" [wordWrapEnabled]="true" [allowColumnResizing]="true"
            [columnHidingEnabled]="false" [showBorders]="true">
            <dxo-filter-row [visible]="false"></dxo-filter-row>
            <dxo-search-panel [visible]="true">
            </dxo-search-panel>
            <dxo-paging [enabled]="true">
            </dxo-paging>
            <dxo-selection mode="single"></dxo-selection>
            <dxi-column [width]="200" caption="{{'action' | translate}}" name="command-editing" [allowFiltering]="false"
                [allowSorting]="false" cellTemplate="cellTemplate">
                <div *dxTemplate="let data of 'cellTemplate'">
                    <dx-button text="Update Details(Batch/Quanties)" (click)="funcUpdateLicenseVisaprod(data.data)"
                        type="success" icon="edit" [elementAttr]="{ class: 'btn btn-primary' }">
                    </dx-button>
                </div>
            </dxi-column>

            <dxi-column dataField="brand_name" caption="{{'brand_item_name' | translate}}"></dxi-column>
            <dxi-column dataField="quantity" caption="{{'quantity' | translate}}"></dxi-column>
            <dxi-column dataField="packaging_units" caption="{{'packaging_units' | translate}}"></dxi-column>
            <dxi-column dataField="pack_size" caption="{{'pack_size' | translate}}"></dxi-column>

            <dxi-column dataField="product_batch_no" caption="{{'product_batch_no(license_permit)' | translate}}"></dxi-column>
            <dxi-column dataField="product_manufacturing_date" caption="{{'product_manufacturing_date' | translate}}"></dxi-column>
            <dxi-column dataField="product_expiry_date" caption="{{'product_expiry_date' | translate}}"></dxi-column>
            <dxi-column dataField="currency_name" caption="{{'currency_name' | translate}}"></dxi-column>
            <dxi-column dataField="unit_price" caption="{{'unit_price' | translate}}"></dxi-column>
            <dxi-column dataField="total_value" caption="{{'total_value' | translate}}"></dxi-column>
            <dxo-paging [enabled]="true">
            </dxo-paging>
            <dxo-summary>
                <dxi-total-item column="total_value" summaryType="sum">
                </dxi-total-item>
            </dxo-summary>
            <dxo-pager [showInfo]="true" infoText="Page #{0}. Total: {1} ({2} items)">
            </dxo-pager>
            <dxo-export [enabled]="true" fileName="permitProducts" [allowExportSelectedData]="true"></dxo-export>
        </dx-data-grid>

    </div>

    <div class="col-lg-12" *ngIf="regulatory_subfunction_id == 78  || regulatory_subfunction_id == 81">
        <dx-data-grid [dataSource]="permitProductsData" [wordWrapEnabled]="true"
            (onToolbarPreparing)="onPermitProductGridToolbar($event)" [allowColumnResizing]="true"
            [columnHidingEnabled]="false" [showBorders]="true">
            <dxo-filter-row [visible]="false"></dxo-filter-row>
            <dxo-search-panel [visible]="true">
            </dxo-search-panel>
            <dxo-paging [enabled]="true">
            </dxo-paging>
            <dxo-selection mode="single"></dxo-selection>
            <dxi-column [width]="150" caption="{{'action' | translate}}" name="command-editing" [allowFiltering]="false"
                [allowSorting]="false" cellTemplate="cellTemplate">
                <div *dxTemplate="let data of 'cellTemplate'">
                    <dx-menu (onItemClick)="permitProductsActionColClick($event,data)" [items]="permitProductMenuItems">

                    </dx-menu>
                </div>
            </dxi-column>
            <dxi-column [width]="200" caption="{{'action' | translate}}" name="command-editing" [allowFiltering]="false"
                [allowSorting]="false" cellTemplate="cellTemplate2">
                <div *dxTemplate="let data of 'cellTemplate2'">
                    <dx-button text="{{'uploads(certificates)' | translate}}" (click)="funcDownloadUploadedDocuments(data.data)"
                        type="success" icon="download" [elementAttr]="{ class: 'btn btn-primary' }">
                    </dx-button>
                </div>
            </dxi-column>
            <dxi-column dataField="brand_name" caption="{{'brand/item Name' | translate}}"></dxi-column>
            <dxi-column dataField="quantity" caption="{{'quantity' | translate}}"></dxi-column>
            <dxi-column dataField="packaging_units" caption="{{'packaging_units' | translate}}"></dxi-column>
            <dxi-column dataField="pack_size" caption="{{'pack_size' | translate}}"></dxi-column>

            <dxi-column dataField="product_batch_no" caption="{{'product_batch_no(license_permit)' | translate}}"></dxi-column>
            <dxi-column dataField="product_manufacturing_date" caption="{{'product_manufacturing_date' | translate}}"></dxi-column>
            <dxi-column dataField="product_expiry_date" caption="{{'product_expiry_date' | translate}}"></dxi-column>
            <dxi-column dataField="currency_name" caption="{{'currency_name' | translate}}"></dxi-column>
            <dxi-column dataField="unit_price" caption="{{'unit_price' | translate}}"></dxi-column>
            <dxi-column dataField="total_value" caption="{{'total_value' | translate}}"></dxi-column>
            <dxo-paging [enabled]="true">
            </dxo-paging>
            <dxo-summary>
                <dxi-total-item column="total_value" summaryType="sum">
                </dxi-total-item>
            </dxo-summary>
            <dxo-pager [showInfo]="true" infoText="Page #{0}. Total: {1} ({2} items)">
            </dxo-pager>
            <dxo-export [enabled]="true" fileName="permitProducts" [allowExportSelectedData]="true"></dxo-export>
        </dx-data-grid>

    </div>

    <div class="col-lg-12" *ngIf="regulatory_subfunction_id == 82">
        <dx-data-grid [dataSource]="permitProductsData"
            (onToolbarPreparing)="onPermitVisaLicenseProductGridToolbar($event)" [allowColumnResizing]="true"
            [columnHidingEnabled]="false" [wordWrapEnabled]="true" [showBorders]="true">
            <dxo-filter-row [visible]="false"></dxo-filter-row>
            <dxo-search-panel [visible]="true">
            </dxo-search-panel>
            <dxo-paging [enabled]="true">
            </dxo-paging>
            <dxo-selection mode="single"></dxo-selection>

            <dxi-column [width]="200" caption="{{'action' | translate}}" name="command-editing" [allowFiltering]="false"
                [allowSorting]="false" cellTemplate="cellTemplate">
                <div *dxTemplate="let data of 'cellTemplate'">
                    <dx-button text="{{'update_details(batch/quanties)' | translate}}" (click)="funcUpdateLicenseVisaprod(data.data)"
                        type="success" icon="edit" [elementAttr]="{ class: 'btn btn-primary' }">
                    </dx-button>
                </div>
            </dxi-column>
            <dxi-column [width]="150" caption="{{'action' | translate}}" name="command-editing" [allowFiltering]="false"
                [allowSorting]="false" cellTemplate="cellTemplate2">
                <div *dxTemplate="let data of 'cellTemplate2'">
                    <dx-button text="Remove product" (click)="funcREmoveProductDetails(data.data)" type="success"
                        icon="trash" [elementAttr]="{ class: 'btn btn-danger' }">
                    </dx-button>
                </div>
            </dxi-column>
            <dxi-column dataField="brand_name" caption="{{'brand_name' | translate}}"></dxi-column>
            <dxi-column dataField="quantity" caption="{{'visa_quantity' | translate}}"></dxi-column>
            <dxi-column dataField="visabalance_quantity" caption="{{'balance_quantity' | translate}}"></dxi-column>
            <dxi-column dataField="packaging_units" caption="{{'packaging_units' | translate}}"></dxi-column>
            <dxi-column dataField="pack_size" caption="{{'pack_size' | translate}}"></dxi-column>
            <dxi-column dataField="currency_name" caption="{{'currency_name' | translate}}"></dxi-column>
            <dxi-column dataField="unit_price" caption="{{'unit_price' | translate}}"></dxi-column>
            <dxi-column dataField="total_value" caption="{{'total_value' | translate}}"></dxi-column>
            <dxi-column dataField="permitprod_recommendation" caption="{{'product_acceptance' | translate}}"></dxi-column>           
            
            <dxo-paging [enabled]="true">
            </dxo-paging>
            <dxo-summary>
                <dxi-total-item column="total_value" summaryType="sum">
                </dxi-total-item>
            </dxo-summary>
            <dxo-pager [showInfo]="true" infoText="Page #{0}. Total: {1} ({2} items)">
            </dxo-pager>
            <dxo-export [enabled]="true" fileName="permitProducts" [allowExportSelectedData]="true"></dxo-export>
        </dx-data-grid>

    </div>
</div>



<dx-popup class="popup" [width]="funcpopWidth(80)" [height]="550" [showTitle]="true"
    title="Approved Visa Product Details" [dragEnabled]="false" [hideOnOutsideClick]="false"
    [(visible)]="isApprovedVisaproductsPopupVisible">
    <div *dxTemplate="let data of 'content'">
        <dx-scroll-view>
            <dx-data-grid [dataSource]="approvedVisaProducts"
                (onToolbarPreparing)="onApprovedVisaProductGridToolbar($event)"
                (onCellPrepared)="onVisaProductCellPrepared($event)" [allowColumnResizing]="true"
                [columnHidingEnabled]="false" [wordWrapEnabled]="true" [showBorders]="true">
                <dxo-filter-row [visible]="false"></dxo-filter-row>
                <dxo-search-panel [visible]="true">
                </dxo-search-panel>
                <dxo-selection mode="single"></dxo-selection>
                <dxi-column [width]="150" caption="{{'action(edit/delete)' | translate}}" name="command-editing" [allowFiltering]="false"
                    [allowSorting]="false" cellTemplate="cellTemplate">
                    <div *dxTemplate="let data of 'cellTemplate'">
                        <dx-button text="{{'add/select_product' | translate}}" (click)="funcSelectApprovedVisaProduct(data.data)"
                            type="success" icon="edit" [elementAttr]="{ class: 'btn btn-primary' }">
                        </dx-button>
                    </div>
                </dxi-column>
                <dxi-column dataField="brand_name" caption="{{'brand_name' | translate}}"></dxi-column>
                <dxi-column dataField="quantity" caption="{{'visa_quantity' | translate}}"></dxi-column>
                <dxi-column dataField="visabalance_quantity" caption="{{'balance_quantity' | translate}}"></dxi-column>
                <dxi-column dataField="packaging_units" caption="{{'packaging_units' | translate}}"></dxi-column>
                <dxi-column dataField="pack_size" caption="{{'pack_size' | translate}}"></dxi-column>
                <dxi-column dataField="currency_name" caption="{{'currency_name' | translate}}"></dxi-column>
                <dxi-column dataField="unit_price" caption="{{'unit_price' | translate}}"></dxi-column>
                <dxi-column dataField="total_value" caption="{{'total_value' | translate}}"></dxi-column>
                <dxi-column dataField="permitprod_recommendation" caption="{{'product_acceptance' | translate}}"></dxi-column>
                
                <dxo-paging [enabled]="true">
                </dxo-paging>
                <dxo-summary>
                    <dxi-total-item column="total_value" summaryType="sum">
                    </dxi-total-item>
                </dxo-summary>
                <dxo-pager [showInfo]="true" infoText="Page #{0}. Total: {1} ({2} items)">
                </dxo-pager>
                <dxo-export [enabled]="true" fileName="permitProducts" [allowExportSelectedData]="true"></dxo-export>
            </dx-data-grid>


        </dx-scroll-view>
    </div>
</dx-popup>


<dx-popup class="popup" [width]="funcpopWidth(90)" [height]="550" [showTitle]="true" title="Permits Products"
    [dragEnabled]="false" [hideOnOutsideClick]="false" [(visible)]="isPermitproductsPopupVisible">
    <div *dxTemplate="let data of 'content'">
        <dx-scroll-view>
            <div class="row no-padding">
                <div class="col-lg-12 ">
                    <dx-data-grid [dataSource]="registeredProductsData" [height]="500" [remoteOperations]='true'
                        (onToolbarPreparing)="onRegisteredProductGridToolbar($event)" [wordWrapEnabled]="true"
                        [columnHidingEnabled]="false" [showBorders]="true">
                        <dxo-filter-row [visible]="false"></dxo-filter-row>
                        <dxo-search-panel [visible]="true">
                        </dxo-search-panel>
                        <dxo-paging [enabled]="true">
                        </dxo-paging>
                        <dxo-pager [showInfo]="true" infoText="Page #{0}. Total: {1} ({2} items)">
                        </dxo-pager>

                        <dxo-selection mode="single"></dxo-selection>
                        <dxi-column [width]="150" caption="{{'action' | translate}}" name="command-editing" [allowFiltering]="false"
                            [allowSorting]="false" cellTemplate="cellTemplate">
                            <div *dxTemplate="let data of 'cellTemplate'">
                                <dx-button text="{{'select_product_details' | translate}}" (click)="funcSelectRegisteredProduct(data)"
                                    type="success" icon="edit" [elementAttr]="{ class: 'btn btn-primary' }">
                                </dx-button>
                            </div>
                        </dxi-column>
                        <dxi-column dataField="brand_name" caption="{{'brand_name' | translate}}"></dxi-column>
                        <dxi-column dataField="certificate_no" caption="{{'certificate_no' | translate}}"></dxi-column>
                        <dxi-column dataField="common_name" caption="{{'common_name' | translate}}"></dxi-column>
                        <dxi-column dataField="product_strength" caption="{{'product_strength' | translate}}"></dxi-column>
                        <dxi-column dataField="dosage_form" caption="{{'dosage_form' | translate}}"></dxi-column>
                        <dxi-column dataField="manufacturer_name" caption="{{'manufacturer_name' | translate}}"></dxi-column>
                        <dxi-column dataField="country_of_origin" caption="{{'country_of_origin' | translate}}"></dxi-column>
                        <dxi-column dataField="retention_status" caption="{{'retention_status' | translate}}"></dxi-column>
                        <dxi-column dataField="validity_status" caption="{{'validity_status' | translate}}"></dxi-column>
                        
                        <dxo-paging [pageSize]="25"></dxo-paging>
                        <dxo-export [enabled]="true" fileName="permitProducts"
                            [allowExportSelectedData]="true"></dxo-export>

                    </dx-data-grid>
                </div>
            </div>
        </dx-scroll-view>
    </div>
</dx-popup>

<dx-popup class="popup" [width]="funcpopWidth(80)" height="funcpopHeight(60)" [showTitle]="true"
    title="Permit Products Details" [dragEnabled]="false" [hideOnOutsideClick]="false"
    [(visible)]="isPermitproductsAddPopupVisible">
    <div *dxTemplate="let data of 'content'">

        <dx-scroll-view>

            <dx-tab-panel (onItemClick)="onPermitsProductsTabCLick($event)">
                <dxi-item title="Products Details" icon="rowfield">
                    <div *dxTemplate>
                        <div class="row col-lg-12">
                            <form role="form" class="row" enctype="multipart/form-data" role="form"
                                [formGroup]="permitProductsFrm" (ngSubmit)="onsavePermitProductdetails()">

                                <div class="col-lg-12 row row-no-margin ">
                                    <div class="col-lg-6 ">
                                        <label>{{productnametitle}}</label>
                                        <dx-text-box [readOnly]="is_brandreadonly" formControlName="brand_name">
                                        </dx-text-box>
                                    </div>
                                    <div class=" col-xs-12 col-md-6 col-lg-6 col-xl-6 input-group">
                                        <div class="col-lg-8">
                                            <label class="control-label">{{common_name_title}}</label>
                                            <dx-select-box [dataSource]="commonNameData" valueExpr="id"
                                                displayExpr="name" [readOnly]="isreadOnlyProducts"
                                                [searchEnabled]="true" formControlName="common_name_id">
                                            </dx-select-box>
                                        </div>
                                        <div class="col-lg-4">
                                            <dx-button text="Add" type="success" icon="fa fa-plus"
                                                [disabled]="isreadOnlyProducts" [elementAttr]="{  class: 'pull-left' }"
                                                (onClick)="onAddNewGenericDetails()">
                                            </dx-button>
                                        </div>
                                    </div>
                                    <div class="col-lg-6" *ngIf="requireUnitPackData  && !is_rawpackagingproduct_type">
                                        <label class="control-label">{{'dosage_forms' | translate }}</label>

                                        <dx-select-box [dataSource]="dosageFormsData" [readOnly]="isDosageReadOnly"
                                            valueExpr="id" displayExpr="name" [searchEnabled]="true"
                                            placeholder="{{'strength_dosage_form' | translate}}" formControlName="dosage_form_id">
                                        </dx-select-box>
                                    </div>
                                    <div class="col-lg-6" *ngIf="!is_rawpackagingproduct_type">
                                        <label>{{'product_classification' | translate}}</label>
                                        <dx-select-box [dataSource]="classificationData" valueExpr="id"
                                            [readOnly]="is_brandreadonly" placeholder="{{'select_category' | translate}}"
                                            displayExpr="name" formControlName="productclassification_id"
                                            [searchEnabled]="true">
                                        </dx-select-box>
                                    </div>

                                    <div class="col-lg-6" *ngIf="isFoodPermitProducts && !is_rawpackagingproduct_type">
                                        <label>{{'product_category' | translate}}</label>
                                        <dx-select-box [dataSource]="productCategoryData" valueExpr="id"
                                            [readOnly]="is_brandreadonly" placeholder="{{'select_category' | translate}}"
                                            displayExpr="name" formControlName="product_category_id"
                                            [searchEnabled]="true">
                                        </dx-select-box>
                                    </div>
                                    <div class="col-lg-6" *ngIf="requireUnitPackData  && !is_rawpackagingproduct_type">
                                        <label>{{ 'product_strength' | translate }}</label>
                                        <dx-text-box placeholder="{{'product_strength_placeholder' | translate}}"  [readOnly]="isreadOnlyProducts"
                                            formControlName="product_strength">
                                        </dx-text-box>
                                    </div>

                                    <div class="col-lg-6" *ngIf="isFoodPermitProducts  && !is_rawpackagingproduct_type">

                                        <label>{{'product_sub_category' | translate}}</label>
                                        <dx-select-box [dataSource]="productSubCategoryData"
                                            (onSelectionChanged)="onProductCategoryCboSelect($event)" valueExpr="id"
                                            displayExpr="name" [searchEnabled]="true"
                                            placeholder="{{'sub_product_category_placeholder' | translate }}"
                                            formControlName="product_subcategory_id">
                                        </dx-select-box>
                                    </div>

                                    <div class="col-lg-6 " *ngIf="device_type_visible  && !is_rawpackagingproduct_type">
                                        <label>{{'device_type' | translate}}</label>
                                        <dx-select-box [dataSource]="deviceTypeData" valueExpr="id"
                                            placeholder="{{'select_device_type_placeholder' | translate}}" displayExpr="name"
                                            formControlName="device_type_id" [searchEnabled]="true">
                                        </dx-select-box>
                                    </div>

                                    <div class="col-lg-6">
                                        <label>{{'pack_size' | translate}}</label>
                                        <dx-text-box placeholder="{{'unit_pack_size_placeholder' | translate}}"  formControlName="unitpack_size">
                                        </dx-text-box>
                                    </div>

                                    <div class=" col-xs-12 col-md-4 col-lg-6 col-xl-6 input-group">
                                        <div class="col-lg-10">
                                            <label class="control-label">{{'manufacturer' | translate}}</label>
                                            <dx-text-box formControlName="manufacturer_name" [readOnly]=true
                                                [showClearButton]="true">

                                            </dx-text-box>
                                        </div>
                                        <div class="col-lg-2">
                                            <dx-button [disabled]="isreadOnlyProducts"
                                                [elementAttr]="{ class: 'btn btn-primary pull-left'}"
                                                style="margin-top:25px  !important;" text="Search Manufacturing Details"
                                                type="default" (onClick)="funcSearchManufacturingSite()">
                                                <i class="fa fa-search"></i>Search Details
                                            </dx-button>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 ">
                                        <label>{{'country_of_origin' | translate}}</label>
                                        <dx-select-box [dataSource]="countries" [readOnly]="isreadOnlyProducts"
                                            valueExpr="id" placeholder="{{'select_country_placeholder' | translate}}"  displayExpr="name"
                                            [searchEnabled]="true" formControlName="country_oforigin_id">
                                        </dx-select-box>
                                    </div>
                                    <div class="col-lg-12 " *ngIf="!is_visaapplication">
                                        <label>{{'product_batch_no' | translate}}</label>
                                        <dx-text-box placeholder="{{'batch_nos_placeholder' | translate}}" formControlName="product_batch_no">
                                        </dx-text-box>
                                    </div>
                                    <div class="col-lg-6 input-group" *ngIf="!is_visaapplication">
                                        <div class="col-lg-6">
                                            <label>{{'manufacturing_date' | translate}}</label>
                                            <dx-date-box dateSerializationFormat="yyyy-MM-dd"
                                                placeholder="{{'manufacturing_date_placeholder' | translate}}"
                                                formControlName="product_manufacturing_date">
                                            </dx-date-box>
                                        </div>
                                        <div class="col-lg-6">
                                            <label>{{'expiry_date' | translate}}</label>
                                            <dx-date-box dateSerializationFormat="yyyy-MM-dd" placeholder="{{'expiry_date_placeholder' | translate}}"
                                                formControlName="product_expiry_date">
                                            </dx-date-box>
                                        </div>

                                    </div>
                                    <div class="col-lg-6 input-group">
                                        <div class="col-lg-6">
                                            <label>{{'item_quantity' | translate}}</label>
                                            <dx-number-box placeholder="{{'item_quantity_placeholder' | translate}}" 
                                                formControlName="quantity">
                                            </dx-number-box>
                                        </div>
                                        <div class="col-lg-6">
                                            <label>{{'packaging_unit' | translate}}</label>
                                            <dx-select-box [dataSource]="packagingUnitsData" valueExpr="id"
                                                placeholder="{{'select_packaging_units_placeholder' | translate}}"  displayExpr="name"
                                                formControlName="packaging_unit_id" [searchEnabled]="true">
                                            </dx-select-box>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 input-group" *ngIf="isFoodPermitProducts">
                                        <div class="col-lg-6">
                                            <label>{{'total_weight' | translate}}</label>
                                            <dx-number-box placeholder="{{'total_weight_placeholder' | translate}}" 
                                                formControlName="total_weight">
                                            </dx-number-box>
                                        </div>
                                        <div class="col-lg-6">
                                            <label>{{'weights_unit' | translate}}</label>
                                            <dx-select-box [dataSource]="weightsUnitData" valueExpr="id"
                                                placeholder="{{'select_weights_units_placeholder' | translate}}" displayExpr="name"
                                                formControlName="weights_units_id" [searchEnabled]="true">
                                            </dx-select-box>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 input-group">
                                        <div class="col-lg-6">
                                            <label>{{'unit_price' | translate}}</label>
                                            <dx-number-box placeholder="{{'unit_price_placeholder' | translate}}"  formControlName="unit_price">
                                            </dx-number-box>
                                        </div>
                                        <div class="col-lg-6 ">
                                            <label>{{'currency' | translate}}</label>
                                            <dx-select-box [dataSource]="currencyData" valueExpr="id"
                                                placeholder="{{'select_currency_placeholder' | translate}}"  displayExpr="name" [searchEnabled]="true"
                                                formControlName="currency_id">
                                            </dx-select-box>
                                        </div>
                                    </div>
                                    <div class="col-lg-12">
                                        <label class="control-label">{{'product_physical_description' | translate}}</label>
                                        <dx-text-area [height]="60" formControlName="productphysical_description"
                                            [readOnly]="isReadOnly" placeholder="{{'physical_description_placeholder' | translate}}">
                                        </dx-text-area>
                                    </div>

                                    <div class="col-lg-12 ">
                                        <input type="hidden" formControlName="id" />
                                        <input type="hidden" formControlName="product_id" />
                                        <input type="hidden" formControlName="visa_quantity" />
                                        <input type="hidden" formControlName="prodcertificate_no" />
                                    </div>
                                    <dx-button text="Save Products Details" (onClick)="onsavePermitProductdetails()"
                                        type="success" icon="save"
                                        [elementAttr]="{ class: 'btn btn-primary; pull-right' }">
                                    </dx-button>
                                </div>
                            </form>
                        </div>
                    </div>
                </dxi-item>
                <dxi-item
                    title="Supporting Documents(Certificate of Analysis/ Certificate of Conformity/ Health Certificate/ Sanitary certificate )(Optional)"
                    icon="rowfield">
                    <div *dxTemplate>
                        <!-- <app-appresumable-documents [regulated_productstype_id]="regulated_productstype_id"
                            [regulatory_function_id]="regulatory_function_id" [status_id]="status_id"
                            [regulatory_subfunction_id]="regulatory_subfunction_id"
                            [application_code]="application_code"></app-appresumable-documents> -->
                    </div>
                </dxi-item>

            </dx-tab-panel>
        </dx-scroll-view>
    </div>
</dx-popup>

<dx-popup class="popup" [width]="funcpopWidth(80)" height="funcpopHeight(60)" [showTitle]="true"
    title="Permit Products Details" [dragEnabled]="false" [hideOnOutsideClick]="false"
    [(visible)]="isPermitVisaLicProductsAddPopupVisible">
    <div *dxTemplate="let data of 'content'">

        <dx-scroll-view>
            <dx-tab-panel (onItemClick)="onPermitsProductsTabCLick($event)">
                <dxi-item title="Products Details" icon="rowfield">
                    <div *dxTemplate>
                        <div class="row col-lg-12">
                            <form role="form" class="row" enctype="multipart/form-data" role="form"
                                [formGroup]="permitProductsFrm" (ngSubmit)="onsavePermitProductdetails()">
                                <div class="col-lg-12 row row-no-margin ">
                                    <div class="col-lg-6 ">
                                        <label>{{productnametitle}}</label>
                                        <dx-text-box [readOnly]="true" formControlName="brand_name">
                                        </dx-text-box>
                                    </div>

                                    <div class=" col-xs-6 col-md-6 col-lg-6 col-xl-6 input-group">
                                        <div class="col-lg-8">
                                            <label class="control-label">{{common_name_title}}</label>
                                            <dx-select-box [dataSource]="commonNameData" valueExpr="id"
                                                displayExpr="name" [readOnly]="isMedicinesProduct"
                                                [searchEnabled]="true" formControlName="common_name_id">
                                            </dx-select-box>
                                        </div>
                                        <div class="col-lg-4">
                                            <dx-button text="Add" type="success" icon="fa fa-plus"
                                                [disabled]="isMedicinesProduct" [elementAttr]="{  class: 'pull-left' }"
                                                (onClick)="onAddNewGenericDetails()">
                                            </dx-button>
                                        </div>
                                    </div>
                                    <div class="col-lg-6" *ngIf="requireUnitPackData  && !is_rawpackagingproduct_type">
                                        <label>{{'product_strength' | translate}}</label>
                                        <dx-text-box placeholder="{{'product_strength_placeholder' | translate}}" [readOnly]="true"
                                            formControlName="product_strength">
                                        </dx-text-box>
                                    </div>

                                    <div class="col-lg-6">
                                        <label>{{'product_unit_pack_size' | translate}}</label>
                                        <dx-text-box placeholder="{{'unit_pack_size_placeholder' | translate}}" 
                                            [readOnly]="isVisaPackSizeProductReadOnly" [readOnly]="ammendReadOnly"
                                            formControlName="unitpack_size">
                                        </dx-text-box>
                                    </div>
                                    <div class=" col-xs-12 col-md-4 col-lg-6 col-xl-6 input-group">
                                        <div class="col-lg-10">
                                            <label class="control-label">{{'manufacturer' | translate}}</label>
                                            <dx-text-box formControlName="manufacturer_name" [readOnly]=true
                                                [showClearButton]="true">

                                            </dx-text-box>
                                        </div>
                                        <div class="col-lg-2">
                                            <dx-button [elementAttr]="{ class: 'btn btn-primary pull-left'}"
                                                [disabled]="true" [disabled]="true" style="margin-top:25px  !important;"
                                                text="Search Manufacturing Details" type="default"
                                                (onClick)="funcSearchManufacturingSite()">
                                                <i class="fa fa-search"></i>Search Details
                                            </dx-button>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 ">
                                        <label>{{'country_of_origin' | translate}}</label>
                                        <dx-select-box [dataSource]="countries" [readOnly]="true" [readOnly]="true"
                                            valueExpr="id" placeholder="{{'select_country_placeholder' | translate}}"  displayExpr="name"
                                            [searchEnabled]="true" formControlName="country_oforigin_id">
                                        </dx-select-box>
                                    </div>
                                    <div class="col-lg-12 ">
                                        <label>{{'product_batch_no' | translate}}</label>
                                        <dx-text-box placeholder="{{'batch_nos_placeholder' | translate}}" formControlName="product_batch_no">
                                        </dx-text-box>
                                    </div>
                                    <div class="col-lg-6 input-group">
                                        <div class="col-lg-6">
                                            <label>{{'manufacturing_date' | translate}}</label>
                                            <dx-date-box dateSerializationFormat="yyyy-MM-dd"
                                                placeholder="{{'manufacturing_date_placeholder' | translate}}" 
                                                formControlName="product_manufacturing_date">
                                            </dx-date-box>
                                        </div>
                                        <div class="col-lg-6">
                                            <label>{{'expiry_date' | translate}}</label>
                                            <dx-date-box dateSerializationFormat="yyyy-MM-dd" placeholder="{{'expiry_date_placeholder' | translate}}" 
                                                formControlName="product_expiry_date">
                                            </dx-date-box>
                                        </div>

                                    </div>
                                    <div class="col-lg-6 input-group">
                                        <div class="col-lg-6">
                                            <label>{{'item_quantity' | translate}}</label>
                                            <dx-number-box placeholder="{{'item_quantity_placeholder' | translate}}" [readOnly]="ammendReadOnly"
                                                 formControlName="quantity">
                                            </dx-number-box>
                                        </div>
                                        <div class="col-lg-6">
                                            <label>{{'packaging_unit' | translate}}</label>
                                            <dx-select-box [dataSource]="packagingUnitsData" valueExpr="id"
                                                [readOnly]="ammendReadOnly" placeholder="{{'select_packaging_units_placeholder' | translate}}"
                                                displayExpr="name" formControlName="packaging_unit_id"
                                                [searchEnabled]="true">
                                            </dx-select-box>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 input-group" *ngIf="isFoodPermitProducts">
                                        <div class="col-lg-6">
                                            <label>{{'total_weight' | translate}}</label>
                                            <dx-number-box placeholder="{{'total_weight_placeholder' | translate}}" [readOnly]="ammendReadOnly"
                                                formControlName="total_weight">
                                            </dx-number-box>
                                        </div>
                                        <div class="col-lg-6">
                                            <label>{{'weights_unit' | translate}}</label>
                                            <dx-select-box [readOnly]="ammendReadOnly" [dataSource]="weightsUnitData"
                                                valueExpr="id" placeholder="{{'select_weights_units_placeholder' | translate}}" displayExpr="name"
                                                formControlName="weights_units_id" [searchEnabled]="true">
                                            </dx-select-box>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 input-group">
                                        <div class="col-lg-6">
                                            <label>{{'unit_price' | translate}}</label>
                                            <dx-number-box placeholder="{{'unit_price_placeholder' | translate}}" [readOnly]="ammendReadOnly"
                                                formControlName="unit_price">
                                            </dx-number-box>
                                        </div>
                                        <div class="col-lg-6 ">
                                            <label>{{'currency' | translate}}</label>
                                            <dx-select-box [dataSource]="currencyData" [readOnly]="ammendReadOnly"
                                                valueExpr="id" placeholder="Select Currency" displayExpr="name"
                                                [searchEnabled]="true" formControlName="currency_id">
                                            </dx-select-box>
                                        </div>
                                    </div>
                                    <div class="col-lg-12 ">

                                        <input type="hidden" formControlName="id" />
                                        <input type="hidden" formControlName="product_id" />
                                        <input type="hidden" formControlName="visa_quantity" />
                                        <input type="hidden" formControlName="prodcertificate_no" />
                                    </div>
                                    <dx-button text="Save Products Details" (onClick)="onsavePermitProductdetails()"
                                        type="success" icon="save"
                                        [elementAttr]="{ class: 'btn btn-primary; pull-right' }">
                                    </dx-button>
                                </div>
                            </form>
                        </div>
                    </div>
                </dxi-item>

                <dxi-item
                    title="Supporting Documents(Certificate of Analysis/ Certificate of Conformity/ Health Certificate/ Sanitary certificate )(Optional)"
                    icon="rowfield">
                    <div *dxTemplate>

                        <!-- <app-appresumable-documents [regulated_productstype_id]="regulated_productstype_id"
                            [regulatory_function_id]="regulatory_function_id" [status_id]="status_id"
                            [regulatory_subfunction_id]="regulatory_subfunction_id"
                            [application_code]="application_code"></app-appresumable-documents> -->
                    </div>
                </dxi-item>

            </dx-tab-panel>

        </dx-scroll-view>
    </div>
</dx-popup>

<dx-popup class="popup" [width]="funcpopWidth(40)" [height]="400" [showTitle]="true" title="Add Details"
    [dragEnabled]="false" [hideOnOutsideClick]="false" [(visible)]="addproductCommonNameModal">

    <div *dxTemplate="let data of 'content'">
        <dx-scroll-view>
            <form [formGroup]="addProductParamsdetailsfrm" class="col-lg-12  div-nopadding" style="background: #fff;"
                enctype="multipart/form-data" role="form" (ngSubmit)="onSaveNewGenericDetails()">
                <div class="col-lg-12">
                    <label class="control-label">{{'name' | translate}}</label>
                    <dx-text-box formControlName="name" placeholder="name" [showClearButton]="true">
                    </dx-text-box>
                </div>
                <div class="col-lg-12">
                    <label class="control-label">{{'description' | translate}}</label>
                    <dx-text-area formControlName="description" placeholder="description">
                    </dx-text-area>
                </div>
                <input type='hidden' value='{{regulated_productstype_id}}' formControlName="regulated_productstype_id" />
                <input type='hidden' value='par_common_names' formControlName="tablename" />

                <div class="col-lg-12">
                    <dx-button text="Save Details" type="success" icon="fa fa-plus"
                        [elementAttr]="{  class: 'pull-left' }" (onClick)="onSaveNewGenericDetails()">
                    </dx-button>
                </div>
            </form>
        </dx-scroll-view>
    </div>
</dx-popup>


<dx-popup class="popup" [width]="funcpopWidth(65)" [height]=620 [showTitle]="true" title="Add Manufacturer"
    [dragEnabled]="false" [hideOnOutsideClick]="false" [(visible)]="isnewmanufacturerModalShow">

    <div *dxTemplate="let data of 'content'" class="row">
        <dx-scroll-view>
            <div class="col-lg-12">
                <form enctype="multipart/form-data" role="form" [formGroup]="manufacturerFrm"
                    (ngSubmit)="onAddManufacturerDetails()">

                    <div class="row">

                        <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6">

                            <label class="control-label">{{'name' | translate}}</label>
                            <dx-text-box formControlName="name">
                            </dx-text-box>

                        </div>
                        <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6">
                            <label class="control-label">{{'country' | translate}}</label>

                            <dx-select-box [dataSource]="countries" valueExpr="id" displayExpr="name"
                                placeholder="{{'select_country_placeholder' | translate}}"  (onSelectionChanged)="onCoutryCboSelect($event)"
                                [searchEnabled]="true" formControlName="country_id">
                            </dx-select-box>
                        </div>
                        <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6">
                            <label for="ti" class="control-label">{{'region/city(optional)' | translate}}</label>

                            <dx-select-box [dataSource]="regions" valueExpr="id" displayExpr="name"
                                [searchEnabled]="true" formControlName="region_id">
                            </dx-select-box>

                        </div>
                        <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6">
                            <label for="ti" class="control-label">{{'email_address' | translate}}</label>
                            <dx-text-box formControlName="email_address" placeholder="Email Address">
                            </dx-text-box>
                        </div>
                        <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6">
                            <label for="ti" class="control-label">{{'postal_address' | translate}}</label>
                            <dx-text-box formControlName="postal_address" placeholder="Postal Address">
                            </dx-text-box>
                        </div>
                        <div class="col-lg-12">
                            <label class="control-label">{{'physical_address' | translate}}</label>

                            <dx-text-area [height]="60" formControlName="physical_address"
                                placeholder="Physical Address">
                            </dx-text-area>
                        </div>
                        <div class="col-lg-12 btn-margin-5">
                            <br />
                            <button type="submit" (submit)="onAddManufacturerDetails()"
                                [disabled]="!manufacturerFrm.valid" class="btn btn-primary"><i class="fa fa-user"></i>
                                Save Manufacturer</button>
                        </div>
                    </div>
                </form>
            </div>
        </dx-scroll-view>
    </div>
</dx-popup>


<dx-popup class="popup" [width]="funcpopWidth(80)" [height]="600" [showTitle]="true" title="Manufacturing Site Details"
    [dragEnabled]="false" [hideOnOutsideClick]="false" [(visible)]="isManufacturerSitePopupVisible">
    <div *dxTemplate="let data of 'content'">
        <dx-scroll-view>
            <dx-data-grid class="table row-border hover" [allowColumnResizing]="true" [wordWrapEnabled]="true"
                [columnHidingEnabled]="true" (onToolbarPreparing)="onManufacturerPreparing($event)"
                [dataSource]="manufacturersData" [remoteOperations]='true' keyExpr="id">
                <dxo-filter-row [visible]="false"></dxo-filter-row>
                <dxo-search-panel [visible]="true">
                </dxo-search-panel>
                <dxo-paging [enabled]="true">
                </dxo-paging>
                <dxo-pager [showInfo]="true" infoText="Page #{0}. Total: {1} ({2} items)">
                </dxo-pager>
                <dxo-export [enabled]="true" fileName="manufacturingFile" [allowExportSelectedData]="true"></dxo-export>
                <dxo-selection mode="single"></dxo-selection>
                <dxo-group-panel [visible]="true"></dxo-group-panel>
                <dxi-column [width]="150" caption="{{'action' | translate}}" name="command-editing" [allowFiltering]="false"
                    [allowSorting]="false" cellTemplate="cellTemplate">
                    <div *dxTemplate="let data of 'cellTemplate'">

                        <dx-button text="{{'select_manufacturer' | translate}}"  (click)="funcSelectManufacturer(data)" type="success"
                            icon="edit" [elementAttr]="{ class: 'btn btn-primary' }">
                        </dx-button>
                    </div>
                </dxi-column>
                <dxi-column dataField="manufacturer_name" caption="{{'manufacturer_name' | translate}}"></dxi-column>
                <dxi-column dataField="country" caption="{{'country' | translate}}"></dxi-column>
                <dxi-column dataField="region" caption="{{'region' | translate}}"></dxi-column>
                <dxi-column dataField="district" caption="{{'district' | translate}}"></dxi-column>
                <dxi-column dataField="physical_address" caption="{{'physical_address' | translate}}"></dxi-column>
                <dxi-column dataField="postal_address" caption="{{'postal_address' | translate}}"></dxi-column>
                <dxi-column dataField="email_address" caption="{{'email_address' | translate}}"></dxi-column>

                <dxo-paging [pageSize]="50"></dxo-paging>
            </dx-data-grid>
        </dx-scroll-view>
    </div>
</dx-popup>

<dx-popup class="popup" [width]="funcpopWidth(80)" [height]="450" [showTitle]="true" title="Document Preview"
    [dragEnabled]="false" [hideOnOutsideClick]="true" [(visible)]="isDocumentPreviewDownloadwin">
    <div *dxTemplate="let data of 'content'" class="row">

        <dx-scroll-view>
            <!-- <app-appresumable-documents [regulated_productstype_id]="regulated_productstype_id"
                [regulatory_function_id]="regulatory_function_id" [status_id]="status_id"
                [regulatory_subfunction_id]="regulatory_subfunction_id"
                [application_code]="application_code"></app-appresumable-documents> -->
        </dx-scroll-view>
    </div>
</dx-popup>


<dx-popup class="popup" [width]="funcpopWidth(90)" [height]="600" [showTitle]="true" title="Uploaded Invoice details "
    [dragEnabled]="false" [hideOnOutsideClick]="true" [(visible)]="isUploadedInvoiceProductsWin">
    <div *dxTemplate="let data of 'content'" class="row">

        <dx-scroll-view>
            <dx-data-grid [dataSource]="permitUploadedProductsData" [wordWrapEnabled]="true"
                (onToolbarPreparing)="onPermitUploadProductGridToolbar($event)" [allowColumnResizing]="true"
                [columnHidingEnabled]="false" [showBorders]="true">
                <dxo-filter-row [visible]="false"></dxo-filter-row>
                <dxo-search-panel [visible]="true">
                </dxo-search-panel>
                <dxo-paging [enabled]="true">
                </dxo-paging>
                <dxo-selection mode="single"></dxo-selection>
                <dxi-column dataField="Syncronisation Status"  caption="{{'syncronisation_status' | translate}}"></dxi-column>
                <dxi-column dataField="brand_name" caption="{{'brand_name' | translate}}"></dxi-column>
                <dxi-column dataField="product_registration_no" caption="{{'certificate_no' | translate}}"></dxi-column>

                <dxi-column dataField="unitpack_size" caption="{{'pack_size' | translate}}"></dxi-column>

                <dxi-column dataField="quantity" caption="{{'quantity' | translate}}"></dxi-column>
                <dxi-column dataField="packaging_units" caption="{{'packaging_units' | translate}}"></dxi-column>


                <!-- <dxi-column dataField="product_batch_no" caption="Product Batch #(License Permit)"></dxi-column>
          <dxi-column dataField="product_manufacturing_date" caption="Mgf Date"></dxi-column>
          <dxi-column dataField="product_expiry_date" caption="Product Expiry Date"></dxi-column>-->

                <dxi-column dataField="currency_name" caption="{{'currency_name' | translate}}"></dxi-column>
                <dxi-column dataField="unit_price"  caption="{{'unit_price' | translate}}"></dxi-column>
                <dxi-column dataField="total_value" caption="{{'total_value' | translate}}"></dxi-column>
                <dxo-paging [enabled]="true">
                </dxo-paging>
                <dxo-summary>
                    <dxi-total-item column="total_value" summaryType="sum">
                    </dxi-total-item>
                </dxo-summary>
                <dxo-pager [showInfo]="true" infoText="Page #{0}. Total: {1} ({2} items)">
                </dxo-pager>
                <dxo-export [enabled]="true" fileName="permitProducts" [allowExportSelectedData]="true"></dxo-export>
            </dx-data-grid>

        </dx-scroll-view>
    </div>
</dx-popup>


<dx-popup class="popup" [width]="funcpopWidth(80)" [height]="700" [showTitle]="true" title="{{printReportTitle}}"
    [dragEnabled]="false" [hideOnOutsideClick]="true" [(visible)]="isPrintReportVisible">
    <div *dxTemplate="let data of 'content'">
        <div class="col-lg-12 row" [innerHTML]="printiframeUrl | safe: 'html'"></div>
    </div>
</dx-popup>

<dx-popup class="popup" [width]="500" [height]="400" [showTitle]="true" title="Upload Option (Invoice Products)"
    [dragEnabled]="false" [hideOnOutsideClick]="false" [(visible)]="isInvoiceProductsUploadVisable">
    <div *dxTemplate="let data of 'content'">
        <form role="form" class="row" enctype="multipart/form-data" role="form" [formGroup]="invoiceProductsUploadFrm"
            (ngSubmit)="onunInvoiceProductsUpload()">

            <div class="col-lg-12">
                <div class="col-lg-12">
                    <label>{{'upload_filled_form' | translate}}</label>
                    <input type="file" class="form-control" (change)="fileChangeEvent($event)" />
                </div>
            </div>
            <div class="col-lg-12">
                <label>{{'invoice_currency' | translate}}</label>
                <dx-select-box [dataSource]="currencyData" valueExpr="id" placeholder="Select Currency"
                    displayExpr="name" [searchEnabled]="true" formControlName="currency_id">
                </dx-select-box>
            </div>
            <div class="col-lg-12">
                <dx-text-area [height]="60" formControlName="description" placeholder="Description">
                </dx-text-area>
            </div>
            <div class="col-lg-12">
                <dx-button text="{{'upload_excel_document' | translate}}"[disabled]="!invoiceProductsUploadFrm.valid"
                    (onClick)="onunInvoiceProductsUpload()" type="success" icon="save"
                    [elementAttr]="{ class: 'btn btn-primary; pull-right' }">
                </dx-button>
            </div>
        </form>
    </div>
</dx-popup>


<dx-popup class="popup" [width]="500" [height]="400" [showTitle]="true" title="Upload Option (Invoice Products)"
    [dragEnabled]="false" [hideOnOutsideClick]="false" [(visible)]="isApprovedVisaProductsUploadVisable">
    <div *dxTemplate="let data of 'content'">
        <form role="form" class="row" enctype="multipart/form-data" role="form" [formGroup]="invoiceProductsUploadFrm"
            (ngSubmit)="onApprovedVisaProductsUpload()">

            <div class="col-lg-12">
                <div class="col-lg-12">
                    <label>{{'upload_filled_form' | translate}}</label>
                    <input type="file" class="form-control" (change)="fileChangeEvent($event)" />
                </div>
            </div>
            <div class="col-lg-12">
                <label>{{'description' | translate}}</label>
                <dx-text-area [height]="60" formControlName="description" placeholder="Description" >
                </dx-text-area>
            </div>
            <div class="col-lg-12">
                <dx-button text="{{'upload_excel_document' | translate}}"[disabled]="!invoiceProductsUploadFrm.valid"
                    (onClick)="onApprovedVisaProductsUpload()" type="success" icon="save"
                    [elementAttr]="{ class: 'btn btn-primary; pull-right' }">
                </dx-button>
            </div>
        </form>
    </div>
</dx-popup>